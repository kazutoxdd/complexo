-----------------------------------------------------------------------------------------------------------------------------------------
-- VRP
-----------------------------------------------------------------------------------------------------------------------------------------
local Tunnel = module("vrp","lib/Tunnel")
-----------------------------------------------------------------------------------------------------------------------------------------
-- CONNECTION
-----------------------------------------------------------------------------------------------------------------------------------------
vSERVER = Tunnel.getInterface("crafting")
-----------------------------------------------------------------------------------------------------------------------------------------
-- CLOSE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("invClose",function()
	SetNuiFocus(false,false)
	SendNUIMessage({ action = "hideNUI" })
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- REQUESTCRAFTING
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("requestCrafting",function(data,cb)
	local inventoryCraft,inventoryUser,invPeso,invMaxpeso = vSERVER.requestCrafting(data["craft"])
	if inventoryCraft then
		cb({ inventoryCraft = inventoryCraft, inventario = inventoryUser, invPeso = invPeso, invMaxpeso = invMaxpeso })
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- FUNCTIONCRAFT
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("functionCraft",function(data)
	if MumbleIsConnected() then
		vSERVER.functionCrafting(data["index"],data["craft"],data["amount"],data["slot"])
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- FUNCTIONDESTROY
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("functionDestroy",function(data)
	if MumbleIsConnected() then
		vSERVER.functionDestroy(data["index"],data["craft"],data["amount"],data["slot"])
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- POPULATESLOT
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("populateSlot",function(data)
	if MumbleIsConnected() then
		TriggerServerEvent("crafting:populateSlot",data["item"],data["slot"],data["target"],data["amount"])
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- UPDATESLOT
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("updateSlot",function(data)
	if MumbleIsConnected() then
		TriggerServerEvent("crafting:updateSlot",data["item"],data["slot"],data["target"],data["amount"])
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- CRAFTING:UPDATE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNetEvent("crafting:Update")
AddEventHandler("crafting:Update",function(Action)
	SendNUIMessage({ action = Action })
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- LIST
-----------------------------------------------------------------------------------------------------------------------------------------
local List = {
	["1"] = { 895.13,-962.75,35.55,"Lavagem" },
	["2"] = { 82.45,-1553.26,29.59,"Lixeiro" },
	["3"] = { 287.36,2843.6,44.7,"Lixeiro" },
	["4"] = { -413.68,6171.99,31.48,"Lixeiro" },
	["5"] = { 1272.26,-1712.57,54.76,"Lester" },
	["6"] = { 46.21,-1749.45,29.64,"Mercado" },

	-- DERIVADOS GUETO
	["7"] = { 103.71,-1995.33,14.88,"Ballas" },
	["8"] = { 228.28,-1752.98,25.24,"Families" },
	["9"] = { 429.43,-2051.89,18.74,"Vagos" },
	["10"] = { 1970.8,3819.14,33.43,"Duros" }, 
	["11"] = { -1077.91,-1675.83,4.57,"Bloods" }, 
	["12"] = { 1268.41,-1710.17,54.76,"Crips" }, 
	["13"] = { -660.05,951.02,243.95,"BLX" },

	-- ARMAS
	["14"] = { -1517.61,112.0,50.04,"PlayBoy" },
	["15"] = { -1839.99,453.37,126.9,"Cosanostra" },
	["16"] = { 2564.17,3866.6,37.32,"LiderYakuza"},

	-- ATTACHS
	["17"] = { 413.29,-1498.45,33.8,"Salieris" },
	["18"] = { -560.66,282.1,85.68,"Arcade" },

	-- MUNICOES
	["19"] = { -1870.52,2061.71,135.44,"Vinhedo" },
	["20"] = { 1402.17,1139.95,109.74,"Fazenda" },

	-- Bennys
	["21"] = { 840.12,-936.93,20.29,"Bennys" },

	-- FAVELAS
	["22"] = { 1278.39,-197.2,105.08,"Grota" },
	["23"] = { 2249.5,51.88,251.42,"FavelaNH" },
	["24"] = { 1777.3,473.46,174.31,"FavelaSV" },
	["25"] = { -128.37,2790.18,53.11,"FavelaDK" },
	["26"] = { 2993.6,3032.56,105.73,"Pedreira" },

	-- CARTÕES E SLA OQ
	["27"] = { 2436.04,4965.34,42.34,"Chacara" },

	-- LAVAGEM
	["28"] = { 95.06,-1292.82,29.27,"Vanilla" },
	["29"] = { -1367.43,-625.62,30.31,"Bahamas" },
	["30"] = { 1115.13,253.42,-45.83,"HotGirls" },

	-- TICKET, LOCKPICK E PLACA
	["31"] = { 978.64,-91.87,74.85,"Motoclub" },
	["32"] = { -76.04,6512.18,31.27,"Primatas" },

	--MUNIÇÃO
	["33"] = {-602.91,-1606.57,27.01,"FerroVelho"}


}
-----------------------------------------------------------------------------------------------------------------------------------------
-- THREADTARGET
-----------------------------------------------------------------------------------------------------------------------------------------
CreateThread(function()
	SetNuiFocus(false,false)

	for k,v in pairs(List) do
		exports["target"]:AddCircleZone("Crafting:"..k,vec3(v[1],v[2],v[3]),0.75,{
			name = "Crafting:"..k,
			heading = 3374176
		},{
			shop = k,
			distance = 1.0,
			options = {
				{
					event = "crafting:openSystem",
					label = "Abrir",
					tunnel = "shop"
				}
			}
		})
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- CRAFTING:OPENSYSTEM
-----------------------------------------------------------------------------------------------------------------------------------------
AddEventHandler("crafting:openSystem",function(Number)
	if List[Number] then
		if vSERVER.requestPerm(List[Number][4]) then
			SetNuiFocus(true,true)
			SendNUIMessage({ action = "showNUI", name = List[Number][4] })
		end
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- CRAFTING:FUELS
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNetEvent("crafting:Fuels")
AddEventHandler("crafting:Fuels",function()
	SetNuiFocus(true,true)
	SendNUIMessage({ action = "showNUI", name = "Fuels" })
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- CRAFTING:OPENSOURCE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNetEvent("crafting:openSource")
AddEventHandler("crafting:openSource",function()
	SetNuiFocus(true,true)
	SendNUIMessage({ action = "showNUI", name = "Inventory" })
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- CRAFTING:CONTAINERS
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNetEvent("crafting:Containers")
AddEventHandler("crafting:Containers",function()
	SetNuiFocus(true,true)
	SendNUIMessage({ action = "showNUI", name = "Containers" })
end)